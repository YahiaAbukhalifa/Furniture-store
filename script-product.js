function getQueryParam(e){return new URLSearchParams(window.location.search).get(e)}async function fetchProductData(e){try{let t=await fetch("./products.json");if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);return(await t.json()).find(t=>t.id===e)}catch(i){console.error("Error fetching product data:",i)}}function displayProductData(e){if(!e){console.error("Product not found");return}document.querySelector(".image-preview img").src=e.image,document.querySelector(".details .title").textContent=e.title,document.querySelector(".details .price").textContent=`${e.price} L.E`;let t=document.querySelector(".details .rating");t.innerHTML="";let i=parseFloat(e.rating),r=Math.floor(i);for(let s=0;s<r;s++){let n=document.createElement("i");n.classList.add("fa-solid","fa-star","active-rate"),t.appendChild(n)}if(i%1!=0){let o=document.createElement("i");o.classList.add("fa-solid","fa-star-half","active-rate"),t.appendChild(o)}for(let a=0;a<5-Math.ceil(i);a++){let d=document.createElement("i");d.classList.add("fa-solid","fa-star"),t.appendChild(d)}let c=document.createElement("span");c.textContent=` (${e.ratingCount})`,t.appendChild(c),document.querySelector(".dimensions .width").textContent=e.dimensions.width,document.querySelector(".dimensions .height").textContent=e.dimensions.height,document.querySelector(".dimensions .depth").textContent=e.dimensions.depth;let l=document.querySelector(".details .colors");l.innerHTML="",e.colors.forEach(e=>{let t=document.createElement("div");t.classList.add(e.toLowerCase()),l.appendChild(t)})}function showMoreProducts(){document.querySelectorAll(".product-item.hidden").forEach(e=>{e.classList.remove("hidden")}),document.getElementById("show-more-products").style.display="none",document.getElementById("view-more-suggest").style.display="none"}function showNotification(e){"serviceWorker"in navigator&&"PushManager"in window?navigator.serviceWorker.ready.then(function(t){t.showNotification("Product Added to Cart",{body:`${e} has been added to your cart.`,icon:"./images/cart-icon.png"})}):"granted"===Notification.permission?new Notification("Product Added to Cart",{body:`${e} has been added to your cart.`,icon:"./images/cart-icon.png"}):"denied"!==Notification.permission&&Notification.requestPermission().then(t=>{"granted"===t&&new Notification("Product Added to Cart",{body:`${e} has been added to your cart.`,icon:"./images/cart-icon.png"})})}document.addEventListener("DOMContentLoaded",async()=>{if("serviceWorker"in navigator)try{await navigator.serviceWorker.register("/service-worker.js"),console.log("Service worker registered successfully")}catch(e){console.error("Service worker registration failed:",e)}let t=getQueryParam("id");if(!t){console.error("No product ID found in URL");return}displayProductData(await fetchProductData(t));let i=document.querySelectorAll(".add-to-cart"),r=document.querySelectorAll(".wishlist");function s(e){let t=JSON.parse(localStorage.getItem("cart"))||[];t.some(t=>t.id===e.id)||(t.push(e),localStorage.setItem("cart",JSON.stringify(t)),o(t),showNotification(e.title))}function n(e,t){let i=JSON.parse(localStorage.getItem("wishlist"))||[],r=i.findIndex(t=>t.id===e.id);-1!==r?(i.splice(r,1),t.classList.remove("liked")):(i.push(e),t.classList.add("liked")),localStorage.setItem("wishlist",JSON.stringify(i)),a(i)}function o(e){document.getElementById("cart-items").innerHTML=e.map(e=>`
            <div class="cart-item">
                <img src="${e.img}" alt="${e.title}">
                <div class="cart-item-details">
                    <p>${e.title}</p>
                    <p>${e.price}</p>
                </div>
                <span class="remove" data-id="${e.id}">&times;</span>
            </div>
        `).join(""),document.querySelectorAll(".cart-item .remove").forEach(e=>{e.addEventListener("click",()=>d(e.dataset.id))})}function a(e){document.getElementById("wishlist-subset").innerHTML=e.map(e=>`
            <div class="wishlist-item">
                <img src="${e.img}" alt="${e.title}">
                <p>${e.title}</p>
                <span class="remove" data-id="${e.id}">&times;</span>
            </div>
        `).join(""),document.querySelectorAll(".wishlist-item .remove").forEach(e=>{e.addEventListener("click",()=>c(e.dataset.id))})}function d(e){let t=JSON.parse(localStorage.getItem("cart"))||[];t=t.filter(t=>t.id!==e),localStorage.setItem("cart",JSON.stringify(t)),o(t)}function c(e){let t=JSON.parse(localStorage.getItem("wishlist"))||[];t=t.filter(t=>t.id!==e),localStorage.setItem("wishlist",JSON.stringify(t)),a(t)}i.forEach(e=>{e.addEventListener("click",()=>{let i=e.closest(".product-info");s({id:t,title:i.querySelector(".title").textContent,img:i.querySelector(".image-preview img").src,price:i.querySelector(".price").textContent})})}),r.forEach(e=>{e.addEventListener("click",()=>{let i=e.closest(".product-info");n({id:t,title:i.querySelector(".title").textContent,img:i.querySelector(".image-preview img").src,price:i.querySelector(".price").textContent},e)})})});
